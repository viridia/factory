{
  "type": "Job",
  "title": "Mandlebrot",
  "description": "Recipe to compute images of the Mandlebrot set.",
  "params": [
    {
      "id": "frames",
      "title": "Frames",
      "type": "range",
      "default": [1, 1]
    }
  ],
  "steps": [
    {
      "id": "render.{{i}}",
      "title": "render",
      "image": "mandelbrot:0.0.1",
      "workdir": "/usr/nimble/sandbox",
      "args": [
        "{{i}}"
      ],
      "multiplicity": {
        "i": "{{frames}}"
      },
      "outputs": [
        "/usr/nimble/sandbox/image.{{i:03}}.jpg"
      ]
    },
    {
      "id": "shoot",
      "title": "shoot movie",
      "image": "opencoconut/ffmpeg",
      "depends": [
        {
          "$foreach": ["n", "{{frames}}", "render.{{n}}"]
        }
      ],
      "workdir": "/usr/nimble/sandbox",
      "args": [
        {
          "$foreach": ["n", "{{frames}}", "image.{{n:03}}.jpg"]
        }
      ],
      "inputs": [
        {
          "$foreach": ["n", "{{frames}}", "/usr/nimble/sandbox/image.{{n:03}}.jpg"]
        }
      ],
      "outputs": [
        "/movies/movie.mp4"
      ]
    }
  ]
}
